<!--  
* ============================================================ 
* File Name   : lsta_PartOrderMyPartList.html  
* Description : wishlist container
* Author      : Evander
* Modification Log  
* ============================================================ 
* Ver  Date          Author         Modification   
* ============================================================  
* 1.0  2025-09-18    Evander        Created 
* ============================================================  
* TODO
toFormatDate 북미포맷
--> 
<template>
    <div class="c-container">

        <template if:true={isLoading}>
            <lightning-spinner
                alternative-text="Loading"
                size="medium"
                class="global-spinner">
            </lightning-spinner>
        </template>

        <div class="header">
            <div class="title slds-grid">
                <div>
                    <div class="slds-grid slds-grid_vertical-align-center">
                        <lightning-icon icon-name="standard:budget" size="medium"></lightning-icon>
                        <div class="page-title__wrap">
                            <div class="page-title">Wishlist</div>
                            <div class="slds-grid title-right">
                                <lightning-button-menu 
                                    alternative-text="Wishlist List" 
                                    label={myPartsListItem.Name}
                                    variant="bare" 
                                    class="wishlist-list" 
                                    onselect={handleListSelect}
                                    data-id="wishlistMenu"
                                >
                                    <template for:each={myPartsList} for:item="myParts">
                                        <lightning-menu-item 
                                            key={myParts.Id} 
                                            value={myParts.Id} 
                                            label={myParts.Name}>
                                        </lightning-menu-item>
                                    </template>
                                </lightning-button-menu>
                            </div>
                        </div>
                        <lightning-button-menu
                            icon-name="standard:settings"
                            alternative-text="Menu"
                            onselect={handleMenuSelect}
                            class="settings-menu-only"
                        >
                            <lightning-menu-item value="create" label="Create List" icon-name="utility:add"></lightning-menu-item>
                            <lightning-menu-item value="clear" label="Clear List" icon-name="utility:clear"></lightning-menu-item>
                            <lightning-menu-item value="delete" label="Delete List" icon-name="utility:delete"></lightning-menu-item>
                            <lightning-menu-item value="edit" label="Edit List" icon-name="utility:edit"></lightning-menu-item>
                        </lightning-button-menu>
                    </div>
                    <p class="slds-page-header__name-meta" style="margin-top:10px">
                        <template for:each={descriptionList} for:item="desc">
                            <div key={desc}>{desc}</div>
                        </template>
                    </p>
                    <p class="slds-page-header__name-meta" style="margin-top:10px">
                        <span class="slds-badge slds-badge_lightest" style="padding-left:10px;padding-right:10px">
                            {selectedRowIdsLength}
                        </span>
                        &nbsp; {infoStatementByLength} selected.
                    </p>
                </div>
                
                <div class="button-wrap slds-grid">
                    <lightning-button
                        label="Add Part"
                        variant="brand-outline"
                        icon-name="utility:add"
                        icon-position="right"
                        onclick={handleClickAddPart}>
                    </lightning-button>

                    <lightning-button
                        label="Delete Part"
                        variant="brand-outline"
                        icon-name="utility:delete"
                        icon-position="right"
                        onclick={handleClickDeletePart}>
                    </lightning-button>

                    <lightning-button
                        label="Upload (csv)"
                        variant="brand-outline"
                        icon-name="utility:upload"
                        icon-position="right"
                        onclick={handleClickUploadCsv}>
                    </lightning-button>

                    <lightning-button
                        label="Form (csv)"
                        variant="brand-outline"
                        icon-name="utility:download"
                        icon-position="right"
                        onclick={handleClickDownloadCsvForm}>
                    </lightning-button>

                    <lightning-button
                        label="Add to Wishlist"
                        variant="brand-outline"
                        icon-name="utility:copy"
                        icon-position="right"
                        onclick={handleClickAddToList}>
                    </lightning-button>

                    <lightning-button
                        label="Print"
                        variant="brand-outline"
                        icon-name="utility:print"
                        icon-position="right"
                        onclick={handleClickPrint}>
                    </lightning-button>

                    <lightning-button
                        label="Add to Cart"
                        variant="brand"
                        icon-name="utility:fulfillment_order"
                        icon-position="right"
                        onclick={handleClickAddToCart}>
                    </lightning-button>
                </div>

            </div>
        </div>

        <!-- Upload 버튼 클릭시 -->
        <template if:true={showUploadSection}>
            <div class="upload-csv">
                <p>
                    <lightning-icon icon-name="utility:info" size="xx-small" class="slds-m-right_xx-small"></lightning-icon>
                    Please download the template for the upload form. Only CSV files are available
                </p>
                <lightning-file-upload
                    label=""
                    name="fileUploader"
                    accept=".csv"
                    class="custom-file-upload"
                    onuploadfinished={handleUploadFinished}>
                </lightning-file-upload>
            </div>
        </template>

        <!-- 테이블 밑에거랑 같이 분리?-->
        <template if:false={displayNoData}>
            <lightning-datatable
                class="c-list-container"
                key-field="id"
                data={wishlistItemsDataTableRows}
                columns={columns}
                selected-rows={selectedRowIds}
                onrowselection={handleRowSelection}>
            </lightning-datatable>
        </template>
        <!-- 데이터 없을시 -->
        <template if:true={displayNoData}>
            <div class="empty-wrap">
                <div class="empty-icon">
                    <lightning-icon icon-name="utility:picklist_type" variant="inverse"></lightning-icon>
                </div>
                <p>Your wishlist is empty!</p>
            </div>
        </template>

        <!-- 모달 -->
        <template if:true={showMenuModal}>
            <c-lsta_-part-order-my-part-list-list-modal
                action={menuModalAction}
                initial-record={myPartsListItem}
                onclose={handleMenuModalClose}
                onsuccess={handleMenuModalSuccess}>
            </c-lsta_-part-order-my-part-list-list-modal>
        </template>
        <template if:true={showAddPartModal}>
            <c-lsta_-part-order-my-part-list-add-part-modal
                my-parts-list-item={myPartsListItem}
                onclose={handleAddPartModalClose}
                onsuccess={handleAddPartModalSuccess}
            ></c-lsta_-part-order-my-part-list-add-part-modal>
        </template>
        <template if:true={showAddToListModal}>
            <c-lsta_-part-order-my-part-list-add-to-list-modal
                onclose={handleAddToListModalClose}
                onsuccess={handleAddToListModalSuccess}
                selected-wishlist-items={selectedItems}
                list-wishlist={listWishlist}
            ></c-lsta_-part-order-my-part-list-add-to-list-modal>
        </template>
        
        <template if:true={showPreCheckModal}>
            <section role="dialog" tabindex="-1" aria-modal="true" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <h2 class="slds-text-heading_medium">Add to Cart</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                        <lightning-input
                            type="checkbox"
                            label="Do CompSet Check"
                            checked={preCheckCheckboxChecked}
                            onchange={handlePreCheckChange}>
                        </lightning-input>
                        <p class="slds-m-top_small">
                            or all selected parts are added to your cart.
                        </p>
                    </div>

                    <footer class="slds-modal__footer slds-grid slds-grid_align-end">
                        <lightning-button
                            variant="neutral"
                            label="Cancel"
                            onclick={handlePreCheckCancel}>
                        </lightning-button>
                        <lightning-button
                            class="slds-m-left_small"
                            variant="brand"
                            label="Confirm"
                            onclick={handlePreCheckConfirm}>
                        </lightning-button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>
        <template if:true={showCompSetModal}>
            <c-lsta_-comp-set-modal
                part-number={checkPartNumber}
                quantity={checkQuantity}
                is-show-modal={trueVar}
                current-page="PartOrderMyPartList"
                onpartadd={handleAddPartCompSetModal}
                onclose={handleCompSetModalClose}>
            </c-lsta_-comp-set-modal>
        </template>
    </div>
</template>